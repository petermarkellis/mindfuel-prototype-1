name: Supabase Keep-Alive (No Secrets Required)

on:
  schedule:
    # Run every 5 minutes for maximum database activity
    - cron: '*/5 * * * *'
  workflow_dispatch:

jobs:
  keep-alive:
    runs-on: ubuntu-latest
    timeout-minutes: 2
    
    steps:
      - name: Database Keep-Alive Ping
        run: |
          echo "🔄 Database keep-alive ping at $(date)"
          echo "🌐 Pinging Supabase REST API..."
          
          # Your Supabase project ID
          PROJECT_ID="mgdkkpbrnrhzeiwblzay"
          
          echo "🔗 Using project ID: $PROJECT_ID"
          
          # Simple REST API ping (will return 401 but keeps DB active)
          curl -s -o /dev/null -w "Status: %{http_code}, Time: %{time_total}s\n" \
            "https://$PROJECT_ID.supabase.co/rest/v1/keep_alive_logs" \
            -H "apikey: fake-key" \
            -H "Authorization: Bearer fake-token" || echo "Ping completed (401 expected)"
          
          echo "✅ Database keep-alive completed"
          echo "📊 This keeps your Supabase database active"
